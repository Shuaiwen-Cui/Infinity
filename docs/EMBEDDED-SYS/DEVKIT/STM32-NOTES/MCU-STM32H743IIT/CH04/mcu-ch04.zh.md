# CH04 STM32H7 基础知识入门
这一章，我们将着重 STM32 开发的一些基础知识，让大家对 STM32 开发有一个初步的了解，为后面 STM32 的学习做一个铺垫，方便后面的学习。这一章的内容大家第一次看的时候可以只了解一个大概，后面需要用到这方面的知识的时候再回过头来仔细看看。这章我们分8个小结，
- 4.1 MDK 下 C 语言基础复习
- 4.2 STM32H7 系统架构
- 4.3 STM32H743 时钟系统
- 4.4 IO 引脚复用器和映射
- 4.5 STM32H7 NVIC 中断优先级管理
- 4.6 MDK 中寄存器地址名称映射分析
- 4.7 MDK 固件库快速开发技巧
- 4.8 手把手教你入门 STM32CubeMX 图形配置工具

## 4.1 MDK 下 C 语言基础复习 🎯

### 4.1.1 C位操作

C语言支持以下六种位操作运算符。

| 运算符 | 含义 | 运算符 | 含义 |
| --- | --- | --- | --- |
| & | 按位与 | ~ | 按位取反 |
| \| | 按位或 | << | 左移 |
| ^ | 按位异或 | >> | 右移 |

### 4.1.2 宏定义

格式：`#define 标识符 字符串`， “标识符”为所定义的宏名。“字符串”可以是常数、表达式、格式串等。

### 4.1.3# ifdef 和 #if defined 条件编译

常见格式
```c
#ifdef 标识符
程序段 1 
#else 
程序段 2 
#endif
```

它的作用是：当标识符已经被定义过(一般是用#define 命令定义)，则对程序段 1 进行编
译，否则编译程序段 2。 其中#else 部分也可以没有，即：

```c
#ifdef 标识符
程序段
#endif
```
### 4.1.4 extern 变量申明
C 语言中 extern 可以置于变量或者函数前，以表示变量或者函数的定义在别的文件中，提示编译器遇到此变量和函数时在其他模块中寻找其定义。**这里面要注意，对于 extern 申明变量可以多次，但定义只有一次。**

### 4.1.5 typedef 类型别名
typedef 用于为现有类型创建一个新的名字，或称为类型别名，用来简化变量的定义。typedef 在 MDK 用得最多的就是定义结构体的类型别名和枚举类型了。

例如
```c
struct _GPIO
{
 __IO uint32_t MODER;
 __IO uint32_t OTYPER;
 …
};
```
以上代码定义了一个结构体_GPIO，这样我们定义变量的方式就是
```c
struct _GPIO GPIOA;//定义结构体变量 GPIOA
```
但是这样很繁琐，MDK 中有很多这样的结构体变量需要定义。这里我们可以为结体定义一个别名 GPIO_TypeDef，这样我们就可以在其他地方通过别名 GPIO_TypeDef 来定义结构体变量
了。方法如下：

```c
typedef struct
{
 __IO uint32_t MODER;
 __IO uint32_t OTYPER;
…
} GPIO_TypeDef;
```
Typedef 为结构体定义一个别名 GPIO_TypeDef，这样我们可以通过 GPIO_TypeDef 来定义结构体变量：
```c
GPIO_TypeDef _GPIOA,_GPIOB;
```
这里的 GPIO_TypeDef 就跟 struct _GPIO 是等同的作用了。 这样是不是方便很多？

### 4.1.6 结构体

声明结构体类型：
```c
Struct 结构体名{
成员列表;
}变量名列表；
```
例如
```c
Struct G_TYPE {
uint32_t Pin;
uint32_t Mode;
uint32_t Speed;
}GPIOA，GPIOB;
```
在结构体申明的时候可以定义变量，也可以申明之后定义，方法是：
```c
Struct 结构体名字 结构体变量列表 ;
```
例如
```c
struct G_TYPE GPIOA,GPIOB;
```
结构体成员变量的引用方法是：
```c
结构体变量名.成员名
```
结构体指针变量定义也是一样的，跟其他变量没有啥区别。例如
```c
struct G_TYPE *GPIOC；//定义结构体指针变量 GPIOC;
```
结构体指针成员变量引用方法是通过“->”符号实现，比如要访问 GPIOC 结构体指针指向的结构体的成员变量 Speed,方法是：
```c
GPIOC->Speed
```
!!! note
    **结构体的好处：**
    任何时候，我们只需要修改结构体成员变量，往结构体中间加入新的成员变量，而不需要修改函数定义就可以达到修改入口参数同样的目的了。这样的好处是不用修改任何函数定义就可以达到增加变量的目的。

!!! tip
    理解了结构体在这个例子中间的作用吗？在以后的开发过程中，如果你的变量定义过多，如果某几个变量是用来描述某一个对象，你可以考虑将这些变量定义在结构体中，这样也许可以提高你的代码的可读性。

## 4.2 STM32H7 系统架构 🎯
~




## 4.3 STM32H743 时钟系统 🎯
### 4.3.1 STM32H7 时钟树概述
![sys_clock_graph](sys_clock_graph.png)

![peripheral_clock_enabling](peripheral_clock_enabling.png)

## 4.4 IO 引脚复用器和映射





## 4.5 STM32H7 NVIC 中断优先级管理






## 4.6 MDK 中寄存器地址名称映射分析





## 4.7 MDK 固件库快速开发技巧







## 4.8 手把手教你入门 STM32CubeMX 图形配置工具 🎯